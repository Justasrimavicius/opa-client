{"ast":null,"code":"import _slicedToArray from\"/Users/justinas/Documents/repos/teamProject/web/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useEffect}from'react';import{useContext}from'react';import{useState}from'react';import{useRef}from'react';import MyContext from'../context';import WordCloudSec from'./MainSections/WordCloudSec';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ScrapeReddit(props){var _useContext=useContext(MyContext),UID=_useContext.UID;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),wordCloud=_useState6[0],activateWordCloud=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),scrapeResults=_useState8[0],setScrapeResults=_useState8[1];var textInputRef=useRef();var resFreqRef=useRef();var scrapeBtnRef=useRef();var previousText=useRef('TEMPLATE MESSAGE');function scrape(){var text=textInputRef.current.value;var freq=resFreqRef.current.value;if(freq=='')freq=100;if(freq!=''&&isNaN(freq)){setError('Result quantity must be a number');return;}if(freq!=''&&freq<100){setError('Word frequency must be greater than 100');return;}if(freq!=''&&freq>1000){setError(\"Word frequency can't be larger then 1000\");}if(text==previousText.current){setError('Type a different word/phrase');return;}else if(text==''){setError(\"Input field can't be empty\");return;}previousText.current=text;setLoading(true);var xhr=new XMLHttpRequest();xhr.open('POST','http://localhost:8080/redditScrapping',true);xhr.setRequestHeader('Content-Type','application/json');xhr.send(JSON.stringify({text:text,freq:freq}));xhr.onload=function(){setLoading(false);var response=JSON.parse(xhr.responseText);if(response.error){setError(response.error);}else if(response.scrappingErr){setError('Uncaught error. Please retry the search');}else{// the response from python is in string format - it needs to be cleaned up and put in arrays properly\n// splits the response string into an array, but the arrays have \"), \" at the end\n// the temp array consists of strings, that contain both the word and the frequancy of the word\nvar temp=xhr.responseText.split('(');// cleanerTemp consists of array of strings without the closing bracket\nvar cleanerTemp=temp.map(function(element){return element.slice(0,element.indexOf(')'));});// evenMoreCleanerTemp is the array, that consists of arrays that in the [0] index have the word, and at [1] have the frequancy\nvar evenMoreCleanerTemp=cleanerTemp.map(function(element){return element.split(', ');});// finalArray is like evenMoreCleanerTemp, but without the unnecessary paranthases in [0]\nsetScrapeResults(evenMoreCleanerTemp.map(function(element){var temporary=[element[0].replaceAll(\"'\",''),parseFloat(element[1])];return temporary;}));}};}useEffect(function(){if(error!==null){setTimeout(function(){setError(null);},2000);}},[error]);useEffect(function(){if(loading==true){scrapeBtnRef.current.classList.add('button-disabled');}if(loading==false&&scrapeBtnRef.current.classList.contains('button-disabled')){activateWordCloud(false);scrapeBtnRef.current.classList.remove('button-disabled');}},[loading]);return/*#__PURE__*/_jsxs(\"div\",{className:\"scrapeReddit\",children:[/*#__PURE__*/_jsx(\"h4\",{style:{fontSize:'2rem',margin:'0'},children:\"Reddit scrapping\"}),/*#__PURE__*/_jsx(\"p\",{className:\"errorMsg\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputs\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"main-text-input\",placeholder:\"Your word\",ref:textInputRef}),/*#__PURE__*/_jsx(\"input\",{className:\"main-text-input\",placeholder:\"Word qty.\",ref:resFreqRef})]}),wordCloud==false?/*#__PURE__*/_jsxs(\"div\",{className:\"input-results\",children:[/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Word\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Frequency\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"input-innerResults\",children:scrapeResults.map(function(singleField,index){console.log(singleField);if(scrapeResults.length==1&&isNaN(singleField[1])){return/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"No results found\"},index);}if(singleField[0]=='&#X200B;'||singleField[0]==\"\\\\u200b\")return;if(isNaN(singleField[1]))return;return/*#__PURE__*/_jsxs(\"ul\",{className:\"reddit-ul\",children:[/*#__PURE__*/_jsx(\"li\",{children:singleField[0]}),/*#__PURE__*/_jsx(\"li\",{children:singleField[1]})]},index);})})]}):/*#__PURE__*/_jsx(WordCloudSec,{array:scrapeResults,goBack:activateWordCloud}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){scrape();},ref:scrapeBtnRef,children:loading==true?/*#__PURE__*/_jsx(\"div\",{className:\"lds-dual-ring\"}):/*#__PURE__*/_jsx(\"p\",{style:{margin:'0'},children:\"Scrape\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){if(scrapeResults.length==0){setError('First, enter a word/phrase to scrape');return;};if(UID==''){setError('You need to log in in order to see the detailed view');return;}activateWordCloud(true);},children:\"Detailed view\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"goBack-btn\",onClick:function onClick(){if(wordCloud==true){activateWordCloud(false);return;}props.setWhatToScrape('');},children:\"Go back\"})]});}export default ScrapeReddit;","map":{"version":3,"names":["React","useEffect","useContext","useState","useRef","MyContext","WordCloudSec","ScrapeReddit","props","UID","error","setError","loading","setLoading","wordCloud","activateWordCloud","scrapeResults","setScrapeResults","textInputRef","resFreqRef","scrapeBtnRef","previousText","scrape","text","current","value","freq","isNaN","xhr","XMLHttpRequest","open","setRequestHeader","send","JSON","stringify","onload","response","parse","responseText","scrappingErr","temp","split","cleanerTemp","map","element","slice","indexOf","evenMoreCleanerTemp","temporary","replaceAll","parseFloat","setTimeout","classList","add","contains","remove","fontSize","margin","singleField","index","console","log","length","setWhatToScrape"],"sources":["/Users/justinas/Documents/repos/teamProject/web/frontend/src/Components/ScrapeReddit.jsx"],"sourcesContent":["import React from 'react';\nimport { useEffect } from 'react';\nimport { useContext } from 'react';\nimport { useState } from 'react';\nimport { useRef } from 'react';\nimport MyContext from '../context';\nimport WordCloudSec from './MainSections/WordCloudSec';\n\nfunction ScrapeReddit(props) {\n    const { UID } = useContext(MyContext);\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(false);\n    const [wordCloud, activateWordCloud] = useState(false);\n\n    const [scrapeResults, setScrapeResults] = useState([]);\n\n    const textInputRef = useRef();\n    const resFreqRef = useRef();\n\n    const scrapeBtnRef = useRef();\n    let previousText = useRef('TEMPLATE MESSAGE');\n    function scrape(){\n\n        const text = textInputRef.current.value;\n        let freq = resFreqRef.current.value;\n        if(freq == '')freq = 100;\n        if(freq != '' && isNaN(freq)){\n            setError('Result quantity must be a number')\n            return;\n        }\n        if(freq != '' && freq < 100){\n            setError('Word frequency must be greater than 100')\n            return;\n        }\n        if(freq != '' && freq > 1000){\n            setError(`Word frequency can't be larger then 1000`)\n        }\n        if(text==previousText.current){\n            setError('Type a different word/phrase');\n            return;\n        } else if(text==''){\n            setError(`Input field can't be empty`);\n            return;\n        }\n        previousText.current = text;\n        setLoading(true);\n\n        let xhr = new XMLHttpRequest();\n        xhr.open('POST','http://localhost:8080/redditScrapping', true);\n        xhr.setRequestHeader('Content-Type', 'application/json');\n        xhr.send(JSON.stringify({\n            text: text,\n            freq: freq\n        }));\n        xhr.onload = ()=>{\n            setLoading(false);\n            const response = JSON.parse(xhr.responseText);\n            if(response.error){\n                setError(response.error);\n            } else if(response.scrappingErr){\n                setError('Uncaught error. Please retry the search')\n            } else {\n                // the response from python is in string format - it needs to be cleaned up and put in arrays properly\n\n                // splits the response string into an array, but the arrays have \"), \" at the end\n                // the temp array consists of strings, that contain both the word and the frequancy of the word\n                const temp = xhr.responseText.split('(');\n\n                // cleanerTemp consists of array of strings without the closing bracket\n                const cleanerTemp = temp.map(element=>{\n                    return element.slice(0,element.indexOf(')'));\n                })\n\n                // evenMoreCleanerTemp is the array, that consists of arrays that in the [0] index have the word, and at [1] have the frequancy\n                const evenMoreCleanerTemp = cleanerTemp.map(element=>{\n                    return element.split(', ')\n                })\n\n                // finalArray is like evenMoreCleanerTemp, but without the unnecessary paranthases in [0]\n                setScrapeResults(evenMoreCleanerTemp.map(element=>{\n                    const temporary = [element[0].replaceAll(`'`,''), parseFloat(element[1])]\n                    return temporary;\n                }))\n            }\n        }\n    }\n    useEffect(()=>{\n        if(error!==null){\n            setTimeout(() => {\n                setError(null);\n            }, 2000);\n        }\n    },[error])\n\n    useEffect(()=>{\n        if(loading==true){\n            scrapeBtnRef.current.classList.add('button-disabled');\n        }\n        if(loading==false && scrapeBtnRef.current.classList.contains('button-disabled')){\n            activateWordCloud(false);\n            scrapeBtnRef.current.classList.remove('button-disabled');\n        }\n    },[loading])\n\n    return (\n        <div className='scrapeReddit'>\n            <h4 style={{fontSize:'2rem',margin:'0'}}>Reddit scrapping</h4>\n            <p className='errorMsg'>{error}</p>\n            <div className='inputs'>\n                <input className='main-text-input' placeholder='Your word' ref={textInputRef}></input>\n                <input className='main-text-input' placeholder='Word qty.' ref={resFreqRef}></input>\n            </div> \n            {wordCloud == false ?\n            <div className='input-results'>\n                <ul>\n                    <li>Word</li>\n                    <li>Frequency</li>\n                </ul>\n                <div className='input-innerResults'>\n                    {scrapeResults.map((singleField,index)=>{\n                        console.log(singleField)\n                        if(scrapeResults.length == 1 && isNaN(singleField[1])){\n                            return <div className='no-results' key={index}>No results found</div>\n                        }\n                        if(singleField[0] == '&#X200B;' || singleField[0] == '\\\\u200b')return;\n                        if(isNaN(singleField[1]))return;\n                        return(\n                            <ul className='reddit-ul' key={index}>\n                                <li>{singleField[0]}</li>\n                                <li>{singleField[1]}</li>\n                            </ul>\n                        )\n                    })}\n                </div>\n            </div>\n            : \n                <WordCloudSec array={scrapeResults} goBack={activateWordCloud}/>\n            }\n\n            <div className='input-buttons'>\n                <button onClick={()=>{scrape()}} ref={scrapeBtnRef}>{loading==true ? <div className=\"lds-dual-ring\"></div> : <p style={{margin:'0'}}>Scrape</p>}</button>\n                <button onClick={()=>{if(scrapeResults.length == 0){setError('First, enter a word/phrase to scrape'); return}; if(UID == ''){setError('You need to log in in order to see the detailed view');return;}activateWordCloud(true)}}>Detailed view</button>\n            </div>\n            <button className='goBack-btn' onClick={()=>{if(wordCloud == true){activateWordCloud(false); return}props.setWhatToScrape('')}}>Go back</button>\n        </div>\n    );\n}\n\nexport default ScrapeReddit;"],"mappings":"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"},"metadata":{},"sourceType":"module"}